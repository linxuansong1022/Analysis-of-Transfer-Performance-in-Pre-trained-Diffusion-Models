2025-04-22 16:39:06,048 - INFO - --- Starting Fine-tuning Orchestrator Script ---
2025-04-22 16:39:06,048 - INFO - Using device: cuda:0
2025-04-22 16:39:06,048 - INFO - Configuration: {'data_dir': '/root/autodl-tmp/WavePrediction/train_data/1/*.npy', 'val_data_dir': '/root/autodl-tmp/WavePrediction/test_data/*.npy', 'state': 'train', 'epoch': 200, 'batch_size': 10, 'T': 1000, 'lr': 1e-05, 'multiplier': 1.0, 'grad_clip': 1.0, 'channel': 64, 'channel_mult': [1, 2, 3, 4], 'attn': [2], 'num_res_blocks': 2, 'dropout': 0.15, 'beta_1': 0.0001, 'beta_T': 0.02, 'seq_length': 128, 'device': 'cuda:0', 'train_load_weight': 'Checkpoints_1d/ckpt_20_.pt', 'save_weight_dir': './Checkpoints_1d_finetune/', 'sampled_dir': './SampledImgs_1d_finetune/', 'nrow': 8, 'sample_interval': 20}
2025-04-22 16:39:06,051 - INFO - 加载数据集...
2025-04-22 16:39:06,053 - INFO - 训练集文件数: 86144, 验证集文件数: 21504
2025-04-22 16:39:06,054 - INFO - 初始化 UNet1D 模型...
2025-04-22 16:39:12,156 - INFO - 尝试从 'Checkpoints_1d/ckpt_20_.pt' 加载预训练权重...
2025-04-22 16:39:12,278 - INFO - 成功加载预训练权重。
2025-04-22 16:39:12,278 - INFO - 初始化 GaussianDiffusionTrainer1DReg...
2025-04-22 16:39:12,282 - INFO - 设置 AdamW 优化器，初始学习率: 1e-05
2025-04-22 16:39:12,284 - INFO - 设置学习率调度器 (Warmup + Cosine)...
2025-04-22 16:39:12,284 - INFO - 开始 Fine-tuning 训练循环...
2025-04-22 16:53:09,232 - INFO - --- Starting Fine-tuning Orchestrator Script ---
2025-04-22 16:53:09,233 - INFO - Using device: cuda:0
2025-04-22 16:53:09,233 - INFO - Configuration: {'data_dir': '/root/autodl-tmp/WavePrediction/train_data/1/*.npy', 'val_data_dir': '/root/autodl-tmp/WavePrediction/test_data/*.npy', 'state': 'train', 'epoch': 200, 'batch_size': 10, 'T': 1000, 'lr': 1e-05, 'multiplier': 1.0, 'grad_clip': 1.0, 'channel': 64, 'channel_mult': [1, 2, 3, 4], 'attn': [2], 'num_res_blocks': 2, 'dropout': 0.15, 'beta_1': 0.0001, 'beta_T': 0.02, 'seq_length': 128, 'device': 'cuda:0', 'train_load_weight': 'Checkpoints_1d/ckpt_20_.pt', 'save_weight_dir': './Checkpoints_1d_finetune/', 'sampled_dir': './SampledImgs_1d_finetune/', 'nrow': 8, 'sample_interval': 20}
2025-04-22 16:53:09,235 - INFO - 加载数据集...
2025-04-22 16:53:09,238 - INFO - 训练集文件数: 86144, 验证集文件数: 21504
2025-04-22 16:53:09,238 - INFO - 初始化 UNet1D 模型...
2025-04-22 16:53:14,915 - INFO - 尝试从 'Checkpoints_1d/ckpt_20_.pt' 加载预训练权重...
2025-04-22 16:53:14,978 - INFO - 成功加载预训练权重。
2025-04-22 16:53:14,979 - INFO - 初始化 GaussianDiffusionTrainer1DReg...
2025-04-22 16:53:14,981 - INFO - 设置 AdamW 优化器，初始学习率: 1e-05
2025-04-22 16:53:14,982 - INFO - 设置学习率调度器 (Warmup + Cosine)...
2025-04-22 16:53:14,983 - INFO - 开始 Fine-tuning 训练循环...
2025-04-22 17:00:34,891 - INFO - --- Starting Fine-tuning Orchestrator Script ---
2025-04-22 17:00:34,891 - INFO - Using device: cuda:0
2025-04-22 17:00:34,891 - INFO - Configuration: {'data_dir': '/root/autodl-tmp/WavePrediction/train_data/1/*.npy', 'val_data_dir': '/root/autodl-tmp/WavePrediction/test_data/*.npy', 'state': 'train', 'epoch': 200, 'batch_size': 10, 'T': 1000, 'lr': 1e-05, 'multiplier': 1.0, 'grad_clip': 1.0, 'channel': 64, 'channel_mult': [1, 2, 3, 4], 'attn': [2], 'num_res_blocks': 2, 'dropout': 0.15, 'beta_1': 0.0001, 'beta_T': 0.02, 'seq_length': 128, 'device': 'cuda:0', 'train_load_weight': 'Checkpoints_1d/ckpt_20_.pt', 'save_weight_dir': './Checkpoints_1d_finetune/', 'sampled_dir': './SampledImgs_1d_finetune/', 'nrow': 8, 'sample_interval': 20}
2025-04-22 17:00:34,894 - INFO - 加载数据集...
2025-04-22 17:00:34,896 - INFO - 训练集文件数: 5384, 验证集文件数: 1344
2025-04-22 17:00:34,896 - INFO - 初始化 UNet1D 模型...
2025-04-22 17:00:40,272 - INFO - 尝试从 'Checkpoints_1d/ckpt_20_.pt' 加载预训练权重...
2025-04-22 17:00:40,332 - INFO - 成功加载预训练权重。
2025-04-22 17:00:40,333 - INFO - 初始化 GaussianDiffusionTrainer1DReg...
2025-04-22 17:00:40,335 - INFO - 设置 AdamW 优化器，初始学习率: 1e-05
2025-04-22 17:00:40,336 - INFO - 设置学习率调度器 (Warmup + Cosine)...
2025-04-22 17:00:40,336 - INFO - 开始 Fine-tuning 训练循环...
2025-04-22 17:05:32,603 - INFO - Epoch: 001, Train_MSE: 0.01511, Val_MSE: 0.01083, LR: 1.000000e-05
2025-04-22 17:05:32,690 - INFO - 保存最佳微调模型 (Epoch 1), 验证 MSE: 0.01083
2025-04-22 17:10:25,852 - INFO - Epoch: 002, Train_MSE: 0.01134, Val_MSE: 0.01027, LR: 1.000000e-05
2025-04-22 17:10:25,962 - INFO - 保存最佳微调模型 (Epoch 2), 验证 MSE: 0.01027
2025-04-22 17:15:18,236 - INFO - Epoch: 003, Train_MSE: 0.01121, Val_MSE: 0.01366, LR: 1.000000e-05
2025-04-22 17:20:10,773 - INFO - Epoch: 004, Train_MSE: 0.01102, Val_MSE: 0.01036, LR: 1.000000e-05
2025-04-22 17:25:03,459 - INFO - Epoch: 005, Train_MSE: 0.01135, Val_MSE: 0.01591, LR: 1.000000e-05
2025-04-22 17:29:56,126 - INFO - Epoch: 006, Train_MSE: 0.01111, Val_MSE: 0.01011, LR: 1.000000e-05
2025-04-22 17:29:56,221 - INFO - 保存最佳微调模型 (Epoch 6), 验证 MSE: 0.01011
2025-04-22 17:34:48,573 - INFO - Epoch: 007, Train_MSE: 0.01116, Val_MSE: 0.01107, LR: 1.000000e-05
2025-04-22 17:39:40,777 - INFO - Epoch: 008, Train_MSE: 0.01109, Val_MSE: 0.01024, LR: 1.000000e-05
2025-04-22 17:44:33,063 - INFO - Epoch: 009, Train_MSE: 0.01069, Val_MSE: 0.01006, LR: 1.000000e-05
2025-04-22 17:44:33,158 - INFO - 保存最佳微调模型 (Epoch 9), 验证 MSE: 0.01006
2025-04-22 17:49:25,405 - INFO - Epoch: 010, Train_MSE: 0.01170, Val_MSE: 0.01031, LR: 1.000000e-05
2025-04-22 17:54:17,075 - INFO - Epoch: 011, Train_MSE: 0.01068, Val_MSE: 0.01127, LR: 1.000000e-05
2025-04-22 17:59:09,198 - INFO - Epoch: 012, Train_MSE: 0.01061, Val_MSE: 0.01138, LR: 1.000000e-05
2025-04-22 18:04:01,520 - INFO - Epoch: 013, Train_MSE: 0.01058, Val_MSE: 0.00989, LR: 1.000000e-05
2025-04-22 18:04:01,590 - INFO - 保存最佳微调模型 (Epoch 13), 验证 MSE: 0.00989
2025-04-22 18:08:53,902 - INFO - Epoch: 014, Train_MSE: 0.01075, Val_MSE: 0.01140, LR: 1.000000e-05
2025-04-22 18:13:46,189 - INFO - Epoch: 015, Train_MSE: 0.01052, Val_MSE: 0.00992, LR: 1.000000e-05
2025-04-22 18:18:38,168 - INFO - Epoch: 016, Train_MSE: 0.01060, Val_MSE: 0.01046, LR: 1.000000e-05
2025-04-22 18:23:30,217 - INFO - Epoch: 017, Train_MSE: 0.01068, Val_MSE: 0.01014, LR: 1.000000e-05
2025-04-22 18:28:22,626 - INFO - Epoch: 018, Train_MSE: 0.01053, Val_MSE: 0.01017, LR: 1.000000e-05
2025-04-22 18:33:22,853 - INFO - Epoch: 019, Train_MSE: 0.01053, Val_MSE: 0.01063, LR: 1.000000e-05
2025-04-22 18:38:21,693 - INFO - Epoch: 020, Train_MSE: 0.01062, Val_MSE: 0.01010, LR: 1.000000e-05
2025-04-22 18:38:21,989 - INFO - Epoch 20: Generating samples...
2025-04-22 18:38:31,143 - ERROR - Epoch 20: Failed during sample generation: [Errno 2] No such file or directory: './SampledImgs_1d_finetune/sample_finetune_020.png'
2025-04-22 18:43:29,769 - INFO - Epoch: 021, Train_MSE: 0.01053, Val_MSE: 0.01023, LR: 1.000000e-05
2025-04-22 18:46:55,832 - INFO - --- Starting Fine-tuning Orchestrator Script ---
2025-04-22 18:46:55,832 - INFO - Using device: cuda:0
2025-04-22 18:46:55,832 - INFO - Configuration: {'data_dir': '/root/autodl-tmp/WavePrediction/train_data/1/*.npy', 'val_data_dir': '/root/autodl-tmp/WavePrediction/test_data/*.npy', 'state': 'train', 'epoch': 200, 'batch_size': 10, 'T': 1000, 'lr': 1e-06, 'multiplier': 2.0, 'grad_clip': 1.0, 'channel': 64, 'channel_mult': [1, 2, 3, 4], 'attn': [2], 'num_res_blocks': 2, 'dropout': 0.15, 'beta_1': 0.0001, 'beta_T': 0.02, 'seq_length': 128, 'device': 'cuda:0', 'train_load_weight': 'Checkpoints_1d/ckpt_20_.pt', 'save_weight_dir': './Checkpoints_1d_finetune/', 'sampled_dir': './SampledImgs_1d_finetune/', 'nrow': 8, 'sample_interval': 20}
2025-04-22 18:46:55,835 - INFO - 加载数据集...
2025-04-22 18:46:55,837 - INFO - 训练集文件数: 5384, 验证集文件数: 1344
2025-04-22 18:46:55,837 - INFO - 初始化 UNet1D 模型...
2025-04-22 18:47:01,381 - INFO - 尝试从 'Checkpoints_1d/ckpt_20_.pt' 加载预训练权重...
2025-04-22 18:47:01,446 - INFO - 成功加载预训练权重。
2025-04-22 18:47:01,446 - INFO - 初始化 GaussianDiffusionTrainer1DReg...
2025-04-22 18:47:01,449 - INFO - 设置 AdamW 优化器，初始学习率: 1e-06
2025-04-22 18:47:01,450 - INFO - 设置学习率调度器 (Warmup + Cosine)...
2025-04-22 18:47:01,450 - INFO - 开始 Fine-tuning 训练循环...
2025-04-22 18:51:53,385 - INFO - Epoch: 001, Train_MSE: 0.05523, Val_MSE: 0.01116, LR: 1.000000e-06
2025-04-22 18:51:53,463 - INFO - 保存最佳微调模型 (Epoch 1), 验证 MSE: 0.01116
2025-04-22 19:03:52,843 - INFO - --- Starting Fine-tuning Orchestrator Script ---
2025-04-22 19:03:52,843 - INFO - Using device: cuda:0
2025-04-22 19:03:52,843 - INFO - Configuration: {'data_dir': '/root/autodl-tmp/WavePrediction/train_data/1/*.npy', 'val_data_dir': '/root/autodl-tmp/WavePrediction/test_data/*.npy', 'state': 'train', 'epoch': 200, 'batch_size': 10, 'T': 1000, 'lr': 1e-06, 'multiplier': 2.0, 'grad_clip': 1.0, 'channel': 64, 'channel_mult': [1, 2, 3, 4], 'attn': [2], 'num_res_blocks': 2, 'dropout': 0.15, 'beta_1': 0.0001, 'beta_T': 0.02, 'seq_length': 128, 'device': 'cuda:0', 'train_load_weight': 'Checkpoints_1d/ckpt_20_.pt', 'save_weight_dir': './Checkpoints_1d_finetune/', 'sampled_dir': './SampledImgs_1d_finetune/', 'nrow': 8, 'sample_interval': 20}
2025-04-22 19:03:52,846 - INFO - 加载数据集...
2025-04-22 19:03:52,849 - INFO - 训练集文件数: 5384, 验证集文件数: 1344
2025-04-22 19:03:52,849 - INFO - 初始化 UNet1D 模型...
2025-04-22 19:04:02,699 - INFO - 尝试从 'Checkpoints_1d/ckpt_20_.pt' 加载预训练权重...
2025-04-22 19:04:02,796 - INFO - 成功加载预训练权重。
2025-04-22 19:04:02,796 - INFO - 初始化 GaussianDiffusionTrainer1DReg...
2025-04-22 19:04:02,799 - INFO - 设置 AdamW 优化器，初始学习率: 1e-06
2025-04-22 19:04:02,800 - INFO - 设置学习率调度器 (Warmup + Cosine)...
2025-04-22 19:04:02,800 - INFO - 开始 Fine-tuning 训练循环...
2025-04-22 19:14:31,056 - INFO - Epoch: 001, Train_MSE: 0.05129, Val_MSE: 0.01027, LR: 1.000000e-06
2025-04-22 19:14:31,168 - INFO - 保存最佳微调模型 (Epoch 1), 验证 MSE: 0.01027
2025-04-22 19:24:58,737 - INFO - Epoch: 002, Train_MSE: 0.00979, Val_MSE: 0.00937, LR: 1.050000e-06
2025-04-22 19:24:58,842 - INFO - 保存最佳微调模型 (Epoch 2), 验证 MSE: 0.00937
2025-04-22 19:35:27,086 - INFO - Epoch: 003, Train_MSE: 0.00922, Val_MSE: 0.00917, LR: 1.100000e-06
2025-04-22 19:35:27,175 - INFO - 保存最佳微调模型 (Epoch 3), 验证 MSE: 0.00917
2025-04-22 19:45:55,616 - INFO - Epoch: 004, Train_MSE: 0.00913, Val_MSE: 0.00913, LR: 1.150000e-06
2025-04-22 19:45:55,725 - INFO - 保存最佳微调模型 (Epoch 4), 验证 MSE: 0.00913
2025-04-22 19:56:21,002 - INFO - Epoch: 005, Train_MSE: 0.00907, Val_MSE: 0.00912, LR: 1.200000e-06
2025-04-22 19:56:21,127 - INFO - 保存最佳微调模型 (Epoch 5), 验证 MSE: 0.00912
2025-04-22 20:06:49,488 - INFO - Epoch: 006, Train_MSE: 0.00894, Val_MSE: 0.00906, LR: 1.250000e-06
2025-04-22 20:06:49,613 - INFO - 保存最佳微调模型 (Epoch 6), 验证 MSE: 0.00906
2025-04-22 20:17:17,633 - INFO - Epoch: 007, Train_MSE: 0.00893, Val_MSE: 0.00907, LR: 1.300000e-06
2025-04-22 20:27:45,917 - INFO - Epoch: 008, Train_MSE: 0.00888, Val_MSE: 0.00885, LR: 1.350000e-06
2025-04-22 20:27:46,025 - INFO - 保存最佳微调模型 (Epoch 8), 验证 MSE: 0.00885
2025-04-22 20:38:13,969 - INFO - Epoch: 009, Train_MSE: 0.00893, Val_MSE: 0.00916, LR: 1.400000e-06
2025-04-22 20:48:37,464 - INFO - Epoch: 010, Train_MSE: 0.00906, Val_MSE: 0.00918, LR: 1.450000e-06
2025-04-22 20:59:03,531 - INFO - Epoch: 011, Train_MSE: 0.00905, Val_MSE: 0.00888, LR: 1.500000e-06
2025-04-22 21:09:29,413 - INFO - Epoch: 012, Train_MSE: 0.00886, Val_MSE: 0.00916, LR: 1.550000e-06
2025-04-22 21:19:55,768 - INFO - Epoch: 013, Train_MSE: 0.00892, Val_MSE: 0.00884, LR: 1.600000e-06
2025-04-22 21:19:55,859 - INFO - 保存最佳微调模型 (Epoch 13), 验证 MSE: 0.00884
2025-04-22 21:30:21,972 - INFO - Epoch: 014, Train_MSE: 0.00884, Val_MSE: 0.00877, LR: 1.650000e-06
2025-04-22 21:30:22,063 - INFO - 保存最佳微调模型 (Epoch 14), 验证 MSE: 0.00877
2025-04-22 21:40:41,778 - INFO - Epoch: 015, Train_MSE: 0.00889, Val_MSE: 0.00881, LR: 1.700000e-06
2025-04-22 21:51:07,868 - INFO - Epoch: 016, Train_MSE: 0.00885, Val_MSE: 0.00929, LR: 1.750000e-06
2025-04-22 22:01:34,252 - INFO - Epoch: 017, Train_MSE: 0.00889, Val_MSE: 0.00876, LR: 1.800000e-06
2025-04-22 22:01:34,350 - INFO - 保存最佳微调模型 (Epoch 17), 验证 MSE: 0.00876
2025-04-22 22:12:00,464 - INFO - Epoch: 018, Train_MSE: 0.00897, Val_MSE: 0.00902, LR: 1.850000e-06
2025-04-22 22:22:26,579 - INFO - Epoch: 019, Train_MSE: 0.00890, Val_MSE: 0.00882, LR: 1.900000e-06
2025-04-22 22:32:49,072 - INFO - Epoch: 020, Train_MSE: 0.00894, Val_MSE: 0.00882, LR: 1.950000e-06
2025-04-22 22:32:49,371 - INFO - Epoch 20: Generating samples...
2025-04-22 22:32:59,596 - ERROR - Epoch 20: Failed during sample generation: [Errno 2] No such file or directory: './SampledImgs_1d_finetune/sample_finetune_020.png'
2025-04-22 22:43:25,408 - INFO - Epoch: 021, Train_MSE: 0.00883, Val_MSE: 0.00873, LR: 2.000000e-06
2025-04-22 22:43:25,523 - INFO - 保存最佳微调模型 (Epoch 21), 验证 MSE: 0.00873
2025-04-22 22:53:51,762 - INFO - Epoch: 022, Train_MSE: 0.00880, Val_MSE: 0.00879, LR: 2.000000e-06
2025-04-22 23:04:18,581 - INFO - Epoch: 023, Train_MSE: 0.00890, Val_MSE: 0.00917, LR: 1.999855e-06
2025-04-22 23:14:46,285 - INFO - Epoch: 024, Train_MSE: 0.00891, Val_MSE: 0.00872, LR: 1.999421e-06
2025-04-22 23:14:46,395 - INFO - 保存最佳微调模型 (Epoch 24), 验证 MSE: 0.00872
2025-04-22 23:25:09,825 - INFO - Epoch: 025, Train_MSE: 0.00889, Val_MSE: 0.00880, LR: 1.998698e-06
2025-04-22 23:35:37,695 - INFO - Epoch: 026, Train_MSE: 0.00889, Val_MSE: 0.00902, LR: 1.997686e-06
